---

- hosts: all
  sudo: true
  vars:
    php_version: "5.6"
    php_packages:
      - php5
      - php5-mcrypt
      - php5-cli
      - php5-common
      - php5-curl
      - php5-dev
      - php5-fpm
      - php5-gd
      - php5-sqlite
      - php-pear
      - libpcre3-dev
    php_conf_paths:
      - /etc/php5/fpm
      - /etc/php5/apache2
      - /etc/php5/cli
    php_extension_conf_paths:
      - /etc/php5/fpm/conf.d
      - /etc/php5/apache2/conf.d
      - /etc/php5/cli/conf.d
    ansible_ssh_user: travis
    drush_version: 7.2.0
    drush_versions:
      - 7.2.0
    drush_packages: []
  roles:
    - { role: ../../geerlingguy.git }
    - { role: ../../geerlingguy.php }
    - { role: ../../geerlingguy.composer }
    - { role: ../../fubarhouse.dvm }
  tasks:
    - name: Get drush status
      shell: "{{ fubarhouse_dvm.dvm_dir }}/drush status"
      register: drush_status
      failed_when:
          - "'.dvm/versions/drush-' not in drush_status.stdout"
